-- CREAR LA TABLA QUE CONTIENE TODOS LOS ÍNDICES. TAMBIÉN INGRESAR LOS DATOS
CREATE TABLE INDICES (
tabla VARCHAR(30),
campo VARCHAR(30),
indice VARCHAR(30),
tipo VARCHAR(30)
)

INSERT INTO INDICES VALUES (
('rech0', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rech0', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rech0', 'HV001', 'INDEX_HV001', 'VARCHAR(8)'),
('rech0', 'HV002', 'INDEX_HV002', 'VARCHAR(4)'),
('rech0', 'HV002A', 'INDEX_HV002A', 'VARCHAR(3)'),
('rech1', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rech1', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rech1', 'HVIDX', 'INDEX_HVIDX', 'VARCHAR(2)'),
('rech4', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rech4', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rech4', 'IDXH4', 'INDEX_IDXH4', 'VARCHAR(2)'),
('rechm', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rechm', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rech23', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rech23', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rec91', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec91', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec0111', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec0111', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rec0111', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec0111', 'V001', 'INDEX_V001', 'VARCHAR(8)'),
('rec0111', 'V002', 'INDEX_V002', 'VARCHAR(4)'),
('rec0111', 'V003', 'INDEX_V003', 'VARCHAR(3)'),
('re223132', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('re223132', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec21', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec21', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec21', 'BORD', 'INDEX_BORD', 'VARCHAR(2)'),
('rec21', 'BIDX', 'INDEX_BIDX', 'VARCHAR(2)'),
('rec41', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec41', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec41', 'MIDX', 'INDEX_MIDX', 'VARCHAR(1)'),
('rec94', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec94', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec94', 'IDX94', 'INDEX_IDX94', 'VARCHAR(1)'),
('rec42', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec42', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('dit', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('dit', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('dit', 'BIDX', 'INDEX_BIDX', 'VARCHAR(2)'),
('dit', 'BORD', 'INDEX_BORD', 'VARCHAR(2)'),
('rec43', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec43', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec43', 'HIDX', 'INDEX_HIDX', 'VARCHAR(1)'),
('rec95', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rec95', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('rec95', 'IDX95', 'INDEX_IDX95', 'VARCHAR(1)'),
('RE516171', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('RE516171', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('RE758081', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('RE758081', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('REC82', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('REC82', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('REC83', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('REC83', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('REC84Dv', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('REC84Dv', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('REC44', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('REC44', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('REC44', 'HWIDX', 'INDEX_HWIDX', 'VARCHAR(1)'),
('RECH5', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('RECH5', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('RECH5', 'HA0', 'INDEX_HA0', 'VARCHAR(2)'),
('rech6', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('rech6', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('rech6', 'HC0', 'INDEX_HC0', 'VARCHAR(2)'),
('rech6', 'HC1', 'INDEX_HC1', 'VARCHAR(2)'),
('rech6', 'HC51', 'INDEX_HC51', 'VARCHAR(2)'),
('rech6', 'HC60', 'INDEX_HC60', 'VARCHAR(3)'),
('rech6', 'HC64', 'INDEX_HC64', 'VARCHAR(2)'),
('REC93DVDISCIPLINA', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('REC93DVDISCIPLINA', 'CASEID', 'INDEX_CASEID', 'VARCHAR(18)'),
('CSALUD01', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('CSALUD01', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('CSALUD01', 'QHCLUSTER', 'INDEX_QHCLUSTER', 'VARCHAR(4)'),
('CSALUD01', 'QHNUMBER', 'INDEX_QHNUMBER', 'VARCHAR(3)'),
('CSALUD01', 'QHHOME', 'INDEX_QHHOME', 'VARCHAR(2)'),
('CSALUD08', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('CSALUD08', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('CSALUD08', 'QHCLUSTER', 'INDEX_QHCLUSTER', 'VARCHAR(4)'),
('CSALUD08', 'QHNUMBER', 'INDEX_QHNUMBER', 'VARCHAR(3)'),
('CSALUD08', 'QHHOME', 'INDEX_QHHOME', 'VARCHAR(2)'),
('CSALUD08', 'QS801', 'INDEX_QS801', 'VARCHAR(2)'),
('PS_WAWAWASI', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('PS_WAWAWASI', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('PS_WAWAWASI', 'HVIDX', 'INDEX_HVIDX', 'VARCHAR(2)'),
('PS_WAWAWASI', 'QHCLUSTER', 'INDEX_QHCLUSTER', 'VARCHAR(4)'),
('PS_WAWAWASI', 'QHNUMBER', 'INDEX_QHNUMBER', 'VARCHAR(3)'),
('PS_WAWAWASI', 'QHHOME', 'INDEX_QHHOME', 'VARCHAR(2)'),
('PS_QALIWARMA', 'ANO', 'INDEX_ANO', 'VARCHAR(4)'),
('PS_QALIWARMA', 'HHID', 'INDEX_HHID', 'VARCHAR(15)'),
('PS_QALIWARMA', 'HVIDX', 'INDEX_HVIDX', 'VARCHAR(2)'),
('PS_QALIWARMA', 'QHCLUSTER', 'INDEX_QHCLUSTER', 'VARCHAR(4)'),
('PS_QALIWARMA', 'QHNUMBER', 'INDEX_QHNUMBER', 'VARCHAR(3)'),
('PS_QALIWARMA', 'QHHOME', 'INDEX_QHHOME', 'VARCHAR(2)');
)

-- CONVERTIR LOS CAMPOS INDICESS DE TODAS LAS TABLAS (Solo es un ejemplo)
ALTER TABLE RECH0 MODIFY ANO VARCHAR(4);

-- CREAR ÍNDICES (Solo es un ejemplo)
CREATE INDEX IND_ANO ON RECH0(ANO);
CREATE INDEX IND_HHID ON RECH0(HHID);

-- UNIÓN DE TABLAS RECH0 Y RECH23 -- ES SOLO PARA COMPROBACIÓN -- VERIFICADO ok

SELECT RECH0.ANO, RECH0.ID1, RECH0.HHID, HV000, HV001, HV002, HV002A, HV003, HV009, HV010, HV015, HV023, HV024, HV025, HV026, HV042, HV022, HV005,
HV201, HV202, HV204, HV205, HV206, HV219, SHREGION, SHSEMES, SHPROVIN, SHDISTRI, HV270, HV271
FROM RECH0
LEFT JOIN RECH23 ON RECH0.ANO = RECH23.ANO AND RECH0.HHID = RECH23.HHID

-- UNIÓN DE TABLAS RECH1, RECH4 Y RECH6 -- ES SOLO PARA COMPROBACIÓN -- VERIFICADO ok

SELECT RECH1.ANO, RECH1.ID1, RECH1.HHID, HVIDX, HV102, HV103, HV104, HV105, HV109, HV112, HV114, HV117, HV120, QH25A, QH25B, 
SH11A, SH11B, SH11C, SH11D, SH11E, SH11Y, SH11Z,
HC1, HC2, HC3, HC27, HC51, HC53, HC55, HC56, HC57, HC60, HC61, HC62, HC63, HC64, HC68
FROM RECH1
JOIN RECH4 ON RECH1.ANO = RECH4.ANO AND RECH1.HHID = RECH4.HHID AND RECH1.HVIDX = RECH4.IDXH4
JOIN RECH6 ON RECH1.ANO = RECH6.ANO AND RECH1.HHID = RECH6.HHID AND RECH1.HVIDX = RECH6.HC0

-- UNIÓN DE TODO RECH -- ES SOLO PARA COMPROBACIÓN -- VERIFICADO ok

SELECT RECH1.ANO, RECH1.ID1, RECH1.HHID, HVIDX, HV102, HV103, HV104, HV105, HV109, HV112, HV114, HV117, HV120, QH25A, QH25B, 
SH11A, SH11B, SH11C, SH11D, SH11E, SH11Y, SH11Z,
HC1, HC2, HC3, HC27, HC51, HC53, HC55, HC56, HC57, HC60, HC61, HC62, HC63, HC64, HC68,
HV000, HV001, HV002, HV002A, HV003, HV009, HV010, HV015, HV023, HV024, HV025, HV026, HV042, HV022, HV005,
HV201, HV202, HV204, HV205, HV206, HV219, SHREGION, SHSEMES, SHPROVIN, SHDISTRI, HV270, HV271
FROM RECH1
LEFT JOIN RECH4 ON RECH1.ANO = RECH4.ANO AND RECH1.HHID = RECH4.HHID AND RECH1.HVIDX = RECH4.IDXH4
JOIN RECH6 ON RECH1.ANO = RECH6.ANO AND RECH1.HHID = RECH6.HHID AND RECH1.HVIDX = RECH6.HC0
LEFT JOIN RECH0 ON RECH1.ANO = RECH0.ANO AND RECH1.HHID = RECH0.HHID
LEFT JOIN RECH23 ON RECH1.ANO = RECH23.ANO AND RECH1.HHID = RECH23.HHID

--

-- AGREGAMOS TABLA WAWAWASI Y LO ALMACENAMOS EN UNA NUEVA TABLA
CREATE TABLE ALL_RECH_PS AS
SELECT RECH1.ANO, RECH1.ID1, RECH1.HHID, RECH1.HVIDX, HV102, HV103, HV104, HV105, HV109, HV112, HV114, HV117, HV120, QH25A, QH25B, 
SH11A, SH11B, SH11C, SH11D, SH11E, SH11Y, SH11Z,
HC1, HC2, HC3, HC27, HC51, HC53, HC55, HC56, HC57, HC60, HC61, HC62, HC63, HC64, HC68,HV005A_RECH6, HV005A_RECH0, HV005X
HV000, RECH0.HV001, RECH0.HV002, RECH0.HV002A, HV003, HV009, HV010, HV015, HV023, HV024, HV025, HV026, HV042, HV022, HV005,
HV201, HV202, HV204, HV205, HV206, HV219, SHREGION, SHSEMES, SHPROVIN, SHDISTRI, HV270, HV271
PS107_1A, PS107_1M, PS107_1S, PS6
FROM RECH1
LEFT JOIN RECH4 ON RECH1.ANO = RECH4.ANO AND RECH1.HHID = RECH4.HHID AND RECH1.HVIDX = RECH4.IDXH4
JOIN RECH6 ON RECH1.ANO = RECH6.ANO AND RECH1.HHID = RECH6.HHID AND RECH1.HVIDX = RECH6.HC0
LEFT JOIN RECH0 ON RECH1.ANO = RECH0.ANO AND RECH1.HHID = RECH0.HHID
LEFT JOIN RECH23 ON RECH1.ANO = RECH23.ANO AND RECH1.HHID = RECH23.HHID
LEFT JOIN PS_WAWAWASI ON RECH1.ANO = PS_WAWAWASI.ANO AND RECH1.HHID = PS_WAWAWASI.HHID AND RECH1.HVIDX = PS_WAWAWASI.HVIDX
	AND RECH0.HV001 = PS_WAWAWASI.QHCLUSTER AND RECH0.HV002 = PS_WAWAWASI.QHNUMBER AND RECH0.HV002A = PS_WAWAWASI.QHHOME

-- REEMPLAZAMOS LOS NULOS O VACÍOS PARA PODER HACER LA CONCATENACIÓN Y POSTERIOR BÚSQUEDA
UPDATE all_rech_ps SET HC51 = '0' WHERE HC51 IS NULL OR HC51 = '';
UPDATE all_rech_ps SET HC60 = '0' WHERE HC60 IS NULL OR HC60 = '';
UPDATE all_rech_ps SET HC64 = '0' WHERE HC64 IS NULL OR HC64 = ''

-- AGREGAR LAS COLUMNAS RELACIONADAS CON LA MADRE, RESPONSABLE Y EL ID DEL NIÑO
ALTER TABLE all_rech_ps ADD COLUMN (ID_Responsable VARCHAR(30) NULL, ID_Madre VARCHAR(30) NULL, ID_Niño_nac VARCHAR(30) NULL);

-- LLENAR LA TABLA CON VALORES A PARTIR DE OTROS CAMPOS

-- Campo ID_Responsable
UPDATE all_rech_ps SET ID_Responsable = CONCAT(all_rech_ps.HHID, RIGHT(CONCAT("  ",all_rech_ps.HC51),3))
-- Verificar 
SELECT HHID, HC51, ID_Responsable FROM all_rech_ps

-- Campo ID_Madre
UPDATE all_rech_ps SET ID_Madre = CONCAT(all_rech_ps.HHID, RIGHT(CONCAT("  ",all_rech_ps.HC60),3))
-- Verificar 
SELECT HHID, HC60, ID_Madre FROM all_rech_ps

-- Campo ID_Niño_nac
UPDATE all_rech_ps SET ID_Niño_nac = CONCAT(all_rech_ps.ID_Madre," ",all_rech_ps.HC64)
-- Verificar 
SELECT ID_Madre, HC64, ID_Niño_nac FROM all_rech_ps


-- UNIÓN DE TABLAS REC43 Y REC95 -- ES SOLO PARA COMPROBACIÓN -- VERIFICADO ok

SELECT REC43.ANO, REC43.ID1, REC43.CASEID, HIDX, H11, H22, H31, H34, H41B, H42,
S45NM1, S45NM2, S45NM3, S45RT1, S45RT2, S466, S466C
FROM REC43
CROSS JOIN REC95 ON REC43.ANO = REC95.ANO AND REC43.CASEID = REC95.CASEID AND REC43.HIDX = REC95.IDX95

-- UNIÓN DE TODO REC
CREATE TABLE ALL_REC AS
SELECT REC43.ANO, REC43.ID1, REC43.CASEID, HIDX, H11, H22, H31, H34, H41B, H42,
S45NM1, S45NM2, S45NM3, S45RT1, S45RT2, S466, S466C,
S425A, S432, S436C, QI422A_A, QI422A_B, QI422A_C, QI422A_D, QI440B,
M4, M5, M14, M18, M19, M19A, M42E, M45, M46, M70, M73,
BORD, B0, B4, B5, B8, Q220A
FROM REC43
CROSS JOIN REC95 ON REC43.ANO = REC95.ANO AND REC43.CASEID = REC95.CASEID AND REC43.HIDX = REC95.IDX95
CROSS JOIN REC94 ON REC43.ANO = REC94.ANO AND REC43.CASEID = REC94.CASEID AND REC43.HIDX = REC94.IDX94
CROSS JOIN REC41 ON REC43.ANO = REC41.ANO AND REC43.CASEID = REC41.CASEID AND REC43.HIDX = REC41.MIDX
CROSS JOIN REC21 ON REC43.ANO = REC21.ANO AND REC43.CASEID = REC21.CASEID AND REC43.HIDX = REC21.BIDX

-- AGREGAR LA COLUMNA RELACIONADA CON EL ID DEL NIÑO
ALTER TABLE all_rec ADD COLUMN ID_Niño_nac VARCHAR(30) NULL;

-- AGREGAMOS EL CAMPO -- Campo ID_Niño_nac
UPDATE all_rec SET ID_Niño_nac = CONCAT(all_rec.CASEID," ",all_rec.BORD)
-- Verificar 
SELECT CASEID, BORD, ID_Niño_nac FROM all_rec

-- RECOPILANDO INFORMACIÓN DE PADRES
SELECT REC0111.ANO, REC0111.ID1, HHID, REC0111.CASEID, V001, V002, V003, V012, V023, V024, V025, V040, V042, V102, V106, V113, V116, V119, V136, AWFACTT, AWFACTU, AWFACTR, AWFACTE, AWFACTW, V155, UBIGEO, V022, V005, V190, V191, MUJERES12A,
V201, V202, V208
FROM REC0111
LEFT JOIN RE223132 ON REC0111.ANO = RE223132.ANO AND REC0111.CASEID = RE223132.CASEID 


-- CONSULTAS GLOBALES PARA UNIR TODAS LAS TABLAS Y VALORES CALCULADOS -- CREACIÓN DE LAS TABLAS INTERMEDIAS

CREATE TABLE ALL_RECH_PS AS
SELECT RECH1.ANO, RECH1.ID1, RECH1.HHID, RECH1.HVIDX, HV102, HV103, HV104, HV105, HV109, HV112, HV114, HV117, HV120, QH25A, QH25B, 
SH11A, SH11B, SH11C, SH11D, SH11E, SH11Y, SH11Z,
HC1, HC2, HC3, HC27, HC51, HC53, HC55, HC56, HC57, HC60, HC61, HC62, HC63, HC64, HC68, HV005A_RECH6, HV005A_RECH0, HV005X
HV000, RECH0.HV001, RECH0.HV002, RECH0.HV002A, HV003, HV009, HV010, HV015, HV023, HV024, HV025, HV026, HV042, HV022, HV005,
HV201, HV202, HV204, HV205, HV206, HV219, SHREGION, SHSEMES, SHPROVIN, SHDISTRI, HV270, HV271,
PS107_1A, PS107_1M, PS107_1S, PS6,
CONCAT(RECH1.HHID, RIGHT(CONCAT("  ",RECH6.HC51),3)) as ID_Responsable,
CONCAT(RECH1.HHID, RIGHT(CONCAT("  ",RECH6.HC60),3)) as ID_Madre,
CONCAT(CONCAT(RECH1.HHID, RIGHT(CONCAT("  ",RECH6.HC60),3))," ",RECH6.HC64) as RECH_ID_Niño_nac
FROM RECH1
LEFT JOIN RECH4 ON RECH1.ANO = RECH4.ANO AND RECH1.HHID = RECH4.HHID AND RECH1.HVIDX = RECH4.IDXH4
JOIN RECH6 ON RECH1.ANO = RECH6.ANO AND RECH1.HHID = RECH6.HHID AND RECH1.HVIDX = RECH6.HC0
LEFT JOIN RECH0 ON RECH1.ANO = RECH0.ANO AND RECH1.HHID = RECH0.HHID
LEFT JOIN RECH23 ON RECH1.ANO = RECH23.ANO AND RECH1.HHID = RECH23.HHID
LEFT JOIN PS_WAWAWASI ON RECH1.ANO = PS_WAWAWASI.ANO AND RECH1.HHID = PS_WAWAWASI.HHID AND RECH1.HVIDX = PS_WAWAWASI.HVIDX AND RECH0.HV001 = PS_WAWAWASI.QHCLUSTER AND RECH0.HV002 = PS_WAWAWASI.QHNUMBER AND RECH0.HV002A = PS_WAWAWASI.QHHOME
;
CREATE INDEX IND_ANO ON ALL_RECH_PS(ANO);
CREATE INDEX IND_HHID ON ALL_RECH_PS(HHID);
CREATE INDEX IND_ID_Niño_nac ON ALL_RECH_PS(RECH_ID_Niño_nac);

CREATE TABLE ALL_REC AS
SELECT REC43.ANO, REC43.ID1, REC43.CASEID, HIDX, H11, H22, H31, H34, H41B, H42,
S45NM1, S45NM2, S45NM3, S45RT1, S45RT2, S466, S466C,
S425A, S432, S436C, QI422A_A, QI422A_B, QI422A_C, QI422A_D, QI440B,
M4, M5, M14, M18, M19, M19A, M42E, M45, M46, M70, M73,
BORD, B0, B4, B5, B8, Q220A,
CONCAT(REC43.CASEID," ",REC21.BORD) AS REC_ID_Niño_nac
FROM REC43
CROSS JOIN REC95 ON REC43.ANO = REC95.ANO AND REC43.CASEID = REC95.CASEID AND REC43.HIDX = REC95.IDX95
CROSS JOIN REC94 ON REC43.ANO = REC94.ANO AND REC43.CASEID = REC94.CASEID AND REC43.HIDX = REC94.IDX94
CROSS JOIN REC41 ON REC43.ANO = REC41.ANO AND REC43.CASEID = REC41.CASEID AND REC43.HIDX = REC41.MIDX
CROSS JOIN REC21 ON REC43.ANO = REC21.ANO AND REC43.CASEID = REC21.CASEID AND REC43.HIDX = REC21.BIDX
;
CREATE INDEX IND_ANO ON ALL_REC(ANO);
CREATE INDEX IND_ID_Niño_nac ON ALL_REC(REC_ID_Niño_nac);

CREATE TABLE ALL_PADRES AS
SELECT REC0111.ANO, REC0111.ID1, REC0111.HHID, REC0111.CASEID, REC0111.V001, REC0111.V002, REC0111.V003, V012, V023, V024, V025, V040, V042, V102, V106, V113, V116, V119, V136, AWFACTT, AWFACTU, AWFACTR, AWFACTE, AWFACTW, V155, UBIGEO, V022, V005, V190, V191, MUJERES12A,
V201, V202, V208
FROM REC0111
LEFT JOIN RE223132 ON REC0111.ANO = RE223132.ANO AND REC0111.CASEID = RE223132.CASEID 
;
CREATE INDEX IND_ANO ON ALL_PADRES(ANO);
CREATE INDEX IND_HHID ON ALL_PADRES(HHID);
CREATE INDEX IND_ID_Niño_nac ON ALL_PADRES(CASEID);



-- similar:

SELECT ANO, HC57, (SUM(FP)/(SELECT SUM(FP) FROM data_indiceanemia WHERE ANO = 2019))*100 AS ind_anemia
FROM data_indiceanemia
WHERE ANO = 2019
GROUP BY ANO, HC57

-- por region =)

SELECT ANO, HV024, HC57, (SUM(FP)/(SELECT SUM(FP) FROM data_indiceanemia WHERE ANO = 2019 AND HV024 = 1))*100 AS ind_anemia
FROM data_indiceanemia
WHERE ANO = 2019 AND HV024 = 1
GROUP BY ANO, HC57